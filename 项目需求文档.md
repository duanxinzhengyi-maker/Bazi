# 八字排盘移动应用 - 项目需求文档

## 1. 项目概述

本项目旨在开发一款移动端八字排盘应用。应用的核心功能是允许用户创建和管理个人档案（包含精确的出生信息），并基于选定档案的真太阳时，自动生成专业、详细的八字命盘，其中包括四柱、大运、流年及流月等关键信息。

## 2. 功能模块需求

### 模块一：档案管理 (主界面)

此模块是应用的入口和档案集中管理中心。

#### 2.1. 档案列表显示

- **列表展示格式**：以列表形式清晰展示所有已保存的档案
- **双行显示结构**：
  - **第一行**：完整显示用户自定义的【昵称】
    - 昵称是自由文本，用户可自行输入编号、文字等任意组合
    - 示例："106-螺扯蛋"
    - 系统不自动生成编号
  - **第二行**：组合显示该档案的【分类】、【公历出生日期与时间】和【出生地点】
- **交互元素**：
  - 列表项前方提供单选框，用于选择目标档案
  - 列表项后方提供【编辑】按钮，点击可修改该档案

#### 2.2. 核心操作按钮

- **【+ 新增】**：
  - 位置：界面下方
  - 功能：点击后跳转至"档案创建"界面
- **【确定选择】**：
  - 位置：界面下方
  - 功能：在用户选择了一个档案后，点击此按钮即进行排盘计算，并跳转至"八字排盘详情"界面
  - 异常处理：若未选择档案，则应有相应提示

#### 2.3. 搜索与筛选功能

- **关键词搜索**：
  - 位置：界面顶部提供搜索框
  - 功能：支持用户输入昵称或备注来实时过滤档案列表
- **分类筛选**：
  - 位置：在搜索框旁设置一个下拉筛选按钮
  - 交互：点击后，从下方弹出分类选项
  - 分类选项：全部、自己、家人、朋友、名人、事件等
  - 功能：用户选择分类后，列表将仅显示该分类下的档案

#### 2.4. 辅助功能

- **上次选择**：一个快捷按钮，用于快速选中上一次排盘的档案
- **文件夹/同步**：为未来功能扩展预留的图标，可考虑云端同步和更复杂的文件夹管理系统

### 模块二：档案创建与编辑

此模块负责所有档案数据的录入和修改。

#### 2.5. 档案信息字段

- **昵称**：
  - 类型：文本输入框
  - 必填：是
  - 说明：用户可自由输入任何内容，系统将其作为完整的字符串进行保存

- **性别**：
  - 类型："男"/"女"单选
  - 必填：是

- **分类**：
  - 类型：从预设的分类列表中选择
  - 选项：同2.3中的分类选项
  - 用途：在档案列表中进行显示和筛选

- **出生日期（阳历）**：
  - 类型：使用日期和时间选择器
  - 精度：需精确到年、月、日、时、分
  - 必填：是

- **出生时区**：
  - 默认：东8区
  - 功能：提供全球时区选择

- **夏令时**：
  - 类型：开关选项
  - 说明：注明我国夏令时实行年份（1986-1991）
  - 用途：供系统精确换算时间

- **出生地**：
  - 必填：是
  - 功能：支持城市选择或地图定位
  - 数据：系统需自动获取并保存该地的经纬度，用于计算真太阳时

- **现居地**：
  - 必填：否
  - 功能：与出生地一样需要记录经纬度

#### 2.6. 操作按钮

- **【保存档案】**：
  - 功能：点击后对数据进行校验（如必填项）
  - 流程：通过后保存并返回档案管理主界面

- **【删除】**：
  - 显示条件：仅在"编辑"模式下显示
  - 安全机制：点击后需有二次确认弹窗，防止误删

### 模块三：八字排盘详情

此模块是应用的核心价值展示界面，用于呈现完整的命盘分析结果。

#### 2.7. 核心计算引擎

- **真太阳时计算**：
  - 输入：用户输入的公历时间、出生地经度和夏令时情况
  - 输出：精确计算出当地的真太阳时

- **排盘算法**：
  - 基础：基于真太阳时
  - 输出：准确排出四柱、大运、流年、流月及所有相关神煞和十神关系

#### 2.8. 命盘信息展示

- **个人信息**：
  - 位置：顶部显示
  - 内容：当前档案的昵称、公历生日

- **四柱八字**：
  - 格式：以表格形式清晰展示
  - 内容：年、月、日、时四柱的天干、地支

- **四柱详解**：
  - 位置：每柱下方
  - 内容：藏干、十神、纳音、神煞、十二长生状态（旺衰）等详细信息

- **大运**：
  - 周期：以10年为一步
  - 格式：列表展示从出生后开始的每一步大运
  - 内容：每步大运需标明起始年龄、公历年份、大运干支、以及对应的十神
  - 高亮：当前所处的大运应有高亮显示

- **流年**：
  - 周期：以年为单位
  - 范围：展示用户所选大运内的或近期的流年
  - 内容：每一年需展示公历年份、流年干支、以及对应的十神
  - 交互：当前年份应有高亮显示，并支持用户左右滑动或选择查看不同年份

- **流月**：
  - 位置：在流年模块下方
  - 联动：根据上方选定的"流年"来联动显示该年内的十二个月份
  - 内容：每个月需展示节气、大致公历日期、流月干支、以及对应的十神
  - 高亮：当前所处的月份应有高亮显示

## 3. 非功能性需求

### 3.1. 准确性
所有天文算法（真太阳时）和命理排盘（节气、干支、大运、流年、流月、神煞等）的结果必须经过严格校对，确保专业级的准确度。

### 3.2. 性能
- 排盘计算应在瞬间完成
- 界面切换和滚动流畅，无卡顿感

### 3.3. 数据安全
- 用户档案属个人隐私，应安全存储于设备本地
- 若开发云同步功能，必须对传输和存储的数据进行加密处理

### 3.4. 用户体验
- 界面设计应简洁、美观，符合现代审美
- 信息布局清晰，主次分明
- 操作流程直观易懂，即使是初学者也能轻松上手

## 4. 技术架构建议

### 4.1. 平台选择
- Android 原生开发
- 使用 Kotlin 作为主要开发语言

### 4.2. 数据存储
- 本地数据库：SQLite 或 Room
- 配置文件：SharedPreferences

### 4.3. 核心算法模块
- 天文计算：真太阳时、节气计算
- 命理算法：干支排盘、大运流年计算
- 地理位置：经纬度获取和时区转换

### 4.4. UI/UX 设计
- Material Design 设计规范
- 响应式布局适配不同屏幕尺寸
- 深色/浅色主题支持

## 5. 开发里程碑

### 阶段一：基础框架搭建
- 项目初始化和基础架构
- 数据库设计和实现
- 基础UI框架

### 阶段二：档案管理功能
- 档案创建和编辑界面
- 档案列表和搜索功能
- 数据验证和存储

### 阶段三：核心算法实现
- 真太阳时计算算法
- 八字排盘核心算法
- 大运流年流月计算

### 阶段四：排盘详情界面
- 命盘信息展示界面
- 交互功能实现
- 数据联动和高亮显示

### 阶段五：优化和测试
- 性能优化
- 算法准确性验证
- 用户体验优化
- 全面测试

## 6. 验收标准

### 6.1. 功能完整性
- 所有需求功能均已实现
- 用户操作流程完整无缺失

### 6.2. 数据准确性
- 排盘结果与专业软件对比验证
- 真太阳时计算精度达到分钟级

### 6.3. 用户体验
- 界面美观，操作直观
- 响应速度满足性能要求
- 无明显bug和崩溃

### 6.4. 兼容性
- 支持主流Android版本
- 适配不同屏幕尺寸和分辨率

---

*本文档基于用户提供的详细需求整理而成，如有补充或修改需求，请及时更新本文档。*